
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Dissipation Corrected Targeted Molecular Dynamics.">
      
      
      
        <link rel="canonical" href="https://moldyn.github.io/dcTMD/reference/dcTMD/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../io/">
      
      
      <link rel="icon" href="../../dctmd_icon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>dcTMD - dcTMD</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
  <!-- Load fonts from Google -->
  
  
  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CPlayfair+Display:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"
  />
  <style>
    :root {
      --md-text-font: "Roboto";
      --md-headline-font: "Playfair Display";
      --md-code-font: "Roboto Mono";
    }
  </style>
  

    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dcTMD.dcTMD" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="dcTMD" class="md-header__button md-logo" aria-label="dcTMD" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../../dctmd_icon.svg" alt="logo" />
  <img id="logo_slate_mode" src="../../dctmd_icon.svg" alt="logo" />

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dcTMD
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              dcTMD
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/moldyn/dcTMD" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/dcTMD
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/" class="md-tabs__link">
          
  
  
  Tutorial

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-tabs__link">
        
  
  
    
  
  MolDyn Freiburg

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="dcTMD" class="md-nav__button md-logo" aria-label="dcTMD" data-md-component="logo">
      <!-- Logo -->

  <img id="logo_default_mode" src="../../dctmd_icon.svg" alt="logo" />
  <img id="logo_slate_mode" src="../../dctmd_icon.svg" alt="logo" />

    </a>
    dcTMD
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/moldyn/dcTMD" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    moldyn/dcTMD
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/theoryMP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/Gromacs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create trajectories with Gromacs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/work/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dcTMD via Work
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/force/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dcTMD via Force
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/CLI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    dcTMD
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            dcTMD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    dcTMD
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    dcTMD
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD" class="md-nav__link">
    <span class="md-ellipsis">
      dcTMD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator" class="md-nav__link">
    <span class="md-ellipsis">
      WorkEstimator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkEstimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy_errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_friction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction_errors" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_friction_errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator" class="md-nav__link">
    <span class="md-ellipsis">
      ForceEstimator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForceEstimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.estimate_free_energy_friction" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy_friction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.memory_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      memory_kernel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    storing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plotting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maintenance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://moldyn.uni-freiburg.de/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MolDyn Freiburg
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD" class="md-nav__link">
    <span class="md-ellipsis">
      dcTMD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator" class="md-nav__link">
    <span class="md-ellipsis">
      WorkEstimator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkEstimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy_errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_friction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction_errors" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_friction_errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator" class="md-nav__link">
    <span class="md-ellipsis">
      ForceEstimator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForceEstimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.estimate_free_energy_friction" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_free_energy_friction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcTMD.dcTMD.ForceEstimator.memory_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      memory_kernel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  

  
                  


  
  


  <h1>dcTMD</h1>

<div class="doc doc-object doc-module">



<a id="dcTMD.dcTMD"></a>
    <div class="doc doc-contents first">

        <p>Classes <code>WorkEstimator</code>, <code>ForceEstimator</code> calculating the dcTMD quantities.</p>
<p>This submodule contains two classes, WorkEstimator and ForceEstimator, which
are used for the dcTMD analysis of constraint force time traces. Both class can
be used to calculate the mean work, dissipative work, free energy and friction
estimate of a set of constraint force time traces.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="dcTMD.dcTMD.WorkEstimator" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">WorkEstimator</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dcTMD.dcTMD._SmoothBasisEstimator">_SmoothBasisEstimator</span></code>, <code><span title="sklearn.base.TransformerMixin">TransformerMixin</span></code>, <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code></p>


        <p>Class for performing dcTMD analysis on a work set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.Float">Float</span>, <span title="dcTMD._typing.Int">Int</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Temperature at which the simulations were carried out, in K.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbose</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Enables verbose mode.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.position_">position_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Positions time trace, product of time trace and velocity, in nm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.W_mean_">W_mean_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Mean work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.W_diss_">W_diss_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Dissipative work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.dG_">dG_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Free energy estimate, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.friction_">friction_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Friction factor in kJ/mol/(nm^2/ps).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.mode_">mode_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Parameter of <a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>. Decides how the bootstrapping
errors are calculated.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.s_W_mean_">s_W_mean_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Bootstrapping error of the mean work. Calculated via <a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.s_W_diss_">s_W_diss_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Bootstrapping error of the dissipative work. Calculated via
<a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.s_dG_">s_dG_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Bootstrapping error of the free energy estimate. Calculated via
<a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.W_mean_resampled_">W_mean_resampled_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Resampled mean work, needed to inspect its distribution. Calculated
via <a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.W_diss_resampled_">W_diss_resampled_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Resampled dissipative work, needed to inspect its distribution.
Calculated via <a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.WorkEstimator.dG_resampled_">dG_resampled_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Resampled free energy estimate, needed to inspect its distribution.
Calculated via <a class="autorefs autorefs-internal" title="estimate_free_energy_errors(n_resamples, mode, seed=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors">WorkEstimator.estimate_free_energy_errors</a>.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.dcTMD</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkEstimator</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.storing</span><span class="w"> </span><span class="kn">import</span> <span class="n">load</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_work_set&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantiate a WorkEstimator instance and fit it with the WorkSet</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># instance work</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span> <span class="o">=</span> <span class="n">WorkEstimator</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">290.15</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">work</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">dG_</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">array([..., ])</span>
</code></pre></div>

        <p>Initialize class.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Float</span><span class="p">,</span> <span class="n">Int</span><span class="p">],</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize class.&quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">work_set</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate free energy and friction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>work_set</code></b>
          –
          <div class="doc-md-description">
            <p>Instance of WorkSet containing constraint force work time traces,
for which the free energy and friction are estimated.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>self</code></b>          –
          <div class="doc-md-description">
            <p>Fitted estimator.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">work_set</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="p">):</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Estimate free energy and friction.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    work_set :</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        Instance of WorkSet containing constraint force work time traces,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        for which the free energy and friction are estimated.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    -------</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    self :</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        Fitted estimator.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">work_set</span> <span class="o">=</span> <span class="n">work_set</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">position_</span> <span class="o">=</span> <span class="n">work_set</span><span class="o">.</span><span class="n">position_</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">names_</span> <span class="o">=</span> <span class="n">work_set</span><span class="o">.</span><span class="n">names_</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">estimate_free_energy</span><span class="p">()</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">estimate_friction</span><span class="p">()</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.transform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return free energy and friction estimates.</p>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">]:</span>  <span class="c1"># noqa: WPS111</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return free energy and friction estimates.&quot;&quot;&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dG_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">friction_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.estimate_free_energy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_free_energy</span><span class="p">(</span><span class="n">work_set</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate free energy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>work_set</code></b>
              (<code><span title="optional">optional</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Instance of a WorkSet containing constraint forces, for which the
free energy and friction are estimated.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>W_mean</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Mean work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>W_diss</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Dissipative work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>dG_</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Free energy estimate, in kJ/mol.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_free_energy</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">work_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">]:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Estimate free energy.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    work_set : optional</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        Instance of a WorkSet containing constraint forces, for which the</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        free energy and friction are estimated.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    -------</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    W_mean : 1D np.array</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        Mean work, in kJ/mol.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    W_diss : 1D np.array</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        Dissipative work, in kJ/mol.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    dG_ : 1D np.array</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        Free energy estimate, in kJ/mol.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="c1"># Besides calculating dcTMD quantitites for the class, this function</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="c1"># is also called from the bootstrapping routine. In the latter case,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="c1"># which comes with a passed work_set parameter, attributes should not</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="c1"># be overwritten.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">if</span> <span class="n">work_set</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">work_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_set</span><span class="o">.</span><span class="n">work_</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">is_bootstrapping</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">is_bootstrapping</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>  <span class="c1"># noqa: WPS347</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">RT</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">/</span> <span class="mf">1e3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">W_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">work_set</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">W_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">work_set</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">W_diss</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">RT</span><span class="p">)</span> <span class="o">*</span> <span class="n">W_var</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">dG</span> <span class="o">=</span> <span class="n">W_mean</span> <span class="o">-</span> <span class="n">W_diss</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_bootstrapping</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">W_mean_</span> <span class="o">=</span> <span class="n">W_mean</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span> <span class="o">=</span> <span class="n">W_diss</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dG_</span> <span class="o">=</span> <span class="n">dG</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">return</span> <span class="n">W_mean</span><span class="p">,</span> <span class="n">W_diss</span><span class="p">,</span> <span class="n">dG</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_free_energy_errors</span><span class="p">(</span><span class="n">n_resamples</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy_errors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate bootstrapping errors for the free energy estimate.</p>
<p>Bootstrapping errors are calculated for the free energy estimate and
the related quantities mean and dissipative work. Return matches the
one of <a class="autorefs autorefs-internal" title="estimate_free_energy(work_set=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy">WorkEstimator.estimate_free_energy</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>n_resamples</code></b>
              (<code><span title="dcTMD._typing.Int">Int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of drawn resamples for bootstrapping error analysis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mode</code></b>
              (<code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.StrStd">StrStd</span>, <span title="dcTMD._typing.NumInRange0to1">NumInRange0to1</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Chooses between reducing the resampled statistic via (1) 'std' the
element-wise calculation of standard deviations or (2) confidence
intervals if <code>mode</code> is a float in [0, 1).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="beartype.typing.Optional">Optional</span>[<span title="dcTMD._typing.Int">Int</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Seed for the random number generator.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>s_W_mean_</code></b> (              <code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.Float1DArray">Float1DArray</span>, <span title="dcTMD._typing.Float2DArray">Float2DArray</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Error estimate of the mean work.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>s_W_diss_</code></b> (              <code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.Float1DArray">Float1DArray</span>, <span title="dcTMD._typing.Float2DArray">Float2DArray</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Error estimate of the mean work.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>s_dG_</code></b> (              <code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.Float1DArray">Float1DArray</span>, <span title="dcTMD._typing.Float2DArray">Float2DArray</span>]</code>
)          –
          <div class="doc-md-description">
            <p>Error estimate of free energy.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.dcTMD</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkEstimator</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">estimate_free_energy_errors</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">Bootstrapping progress: 100%|██████████| 1000/1000 [00:00&lt;00:00, 12797.15it/s]  # noqa</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">s_dG_</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([..., ])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="nd">@beartype</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_free_energy_errors</span><span class="p">(</span>  <span class="c1"># noqa: WPS320</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">n_resamples</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">StrStd</span><span class="p">,</span> <span class="n">NumInRange0to1</span><span class="p">],</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float2DArray</span><span class="p">],</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>               <span class="n">Union</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float2DArray</span><span class="p">],</span>  <span class="c1"># noqa: WPS318</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>               <span class="n">Union</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float2DArray</span><span class="p">],</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>               <span class="p">]:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Estimate bootstrapping errors for the free energy estimate.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Bootstrapping errors are calculated for the free energy estimate and</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        the related quantities mean and dissipative work. Return matches the</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        one of [WorkEstimator.estimate_free_energy][dcTMD.dcTMD.WorkEstimator.\</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">estimate_free_energy].</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        n_resamples :</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            Number of drawn resamples for bootstrapping error analysis.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        mode :</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            Chooses between reducing the resampled statistic via (1) &#39;std&#39; the</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            element-wise calculation of standard deviations or (2) confidence</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            intervals if `mode` is a float in [0, 1).</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        seed :</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            Seed for the random number generator.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        -------</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        s_W_mean_ :</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            Error estimate of the mean work.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        s_W_diss_ :</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            Error estimate of the mean work.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        s_dG_ :</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            Error estimate of free energy.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        --------</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        &gt;&gt;&gt; from dcTMD.dcTMD import WorkEstimator</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        &gt;&gt;&gt; work_estimator.estimate_free_energy_errors(1000, mode=&#39;std&#39;)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        Bootstrapping progress: 100%|██████████| 1000/1000 [00:00&lt;00:00, 12797.15it/s]  # noqa</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        &gt;&gt;&gt; work_estimator.s_dG_</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        array([..., ])</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">free_energy_error_</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="s1">&#39;n_resamples&#39;</span><span class="p">:</span> <span class="n">n_resamples</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="p">}</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bootstrap_free_energy</span><span class="p">()</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_W_mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_W_diss_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_dG_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.estimate_friction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_friction</span><span class="p">(</span><span class="n">W_diss</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate bootstrapping errors for the friction.</p>
<p>Besides calculating dcTMD quantities to the class, this function
is also called from the bootstrapping routine. In the latter case,
which comes with a passed <code>W_diss</code> parameter, attributes should not
be overwritten.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>W_diss</code></b>
              (<code><span title="beartype.typing.Optional">Optional</span>[<span title="dcTMD._typing.Float1DArray">Float1DArray</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Dissipative work, in kJ/mol. Is passed if this function is used
during bootstrapping.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>friction</code></b> (              <code><span title="dcTMD._typing.Float1DArray">Float1DArray</span></code>
)          –
          <div class="doc-md-description">
            <p>Friction factor in kJ/mol/(nm^2/ps).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_friction</span><span class="p">(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">W_diss</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float1DArray</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Estimate bootstrapping errors for the friction.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Besides calculating dcTMD quantities to the class, this function</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    is also called from the bootstrapping routine. In the latter case,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    which comes with a passed `W_diss` parameter, attributes should not</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    be overwritten.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    W_diss :</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Dissipative work, in kJ/mol. Is passed if this function is used</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        during bootstrapping.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    -------</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    friction :</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Friction factor in kJ/mol/(nm^2/ps).</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">if</span> <span class="n">W_diss</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">is_bootstrapping</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">W_diss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimate_free_energy</span><span class="p">()</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">W_diss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">is_bootstrapping</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">delta_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_set</span><span class="o">.</span><span class="n">position_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_set</span><span class="o">.</span><span class="n">position_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;calculating friction, delta_x: </span><span class="si">{</span><span class="n">delta_x</span><span class="si">}</span><span class="s1">nm&#39;</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">friction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="n">W_diss</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="n">W_diss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">delta_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_set</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_bootstrapping</span><span class="p">:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">friction_</span> <span class="o">=</span> <span class="n">friction</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">return</span> <span class="n">friction</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.WorkEstimator.estimate_friction_errors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_friction_errors</span><span class="p">(</span><span class="n">n_resamples</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.WorkEstimator.estimate_friction_errors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate bootstrapping errors for the free energy estimate.</p>
<p>Bootstrapping errors are calculated for the free energy estimate and
the related quantities mean and dissipative work. Return matches the
one of <a class="autorefs autorefs-internal" title="estimate_free_energy(work_set=None)" href="#dcTMD.dcTMD.WorkEstimator.estimate_free_energy">WorkEstimator.estimate_free_energy</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>n_resamples</code></b>
              (<code><span title="dcTMD._typing.Int">Int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of drawn resamples for bootstrapping error analysis.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>mode</code></b>
              (<code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.StrStd">StrStd</span>, <span title="dcTMD._typing.NumInRange0to1">NumInRange0to1</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Chooses between reducing the resampled statistic via
    1.  'std' the element-wise calculation of standard deviations,
    2.  confidence intervals if <code>mode</code> is a float in [0, 1).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>seed</code></b>
              (<code><span title="beartype.typing.Optional">Optional</span>[<span title="dcTMD._typing.Int">Int</span>]</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Seed for the random number generator.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>s_friction_</code></b> (              <code><span title="dcTMD._typing.Float1DArray">Float1DArray</span></code>
)          –
          <div class="doc-md-description">
            <p>Bootstrap error of the friction factor in kJ/mol/(nm^2/ps).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.dcTMD</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkEstimator</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">estimate_friction_errors</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">Bootstrapping progress: 100%|██████████| 1000/1000 [00:00&lt;00:00, 10245.63it/s]  # noqa</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">work_estimator</span><span class="o">.</span><span class="n">s_friction_</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">array([..., ])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="nd">@beartype</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_friction_errors</span><span class="p">(</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="n">n_resamples</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">mode</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">StrStd</span><span class="p">,</span> <span class="n">NumInRange0to1</span><span class="p">],</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float1DArray</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        Estimate bootstrapping errors for the free energy estimate.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        Bootstrapping errors are calculated for the free energy estimate and</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        the related quantities mean and dissipative work. Return matches the</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        one of [WorkEstimator.estimate_free_energy][dcTMD.dcTMD.WorkEstimator.\</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">estimate_free_energy].</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        n_resamples :</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            Number of drawn resamples for bootstrapping error analysis.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        mode :</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">            Chooses between reducing the resampled statistic via</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">                1.  &#39;std&#39; the element-wise calculation of standard deviations,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">                2.  confidence intervals if `mode` is a float in [0, 1).</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        seed :</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            Seed for the random number generator.</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        -------</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        s_friction_ :</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            Bootstrap error of the friction factor in kJ/mol/(nm^2/ps).</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        --------</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        &gt;&gt;&gt; from dcTMD.dcTMD import WorkEstimator</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        &gt;&gt;&gt; work_estimator.estimate_friction_errors(1000, mode=&#39;std&#39;)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        Bootstrapping progress: 100%|██████████| 1000/1000 [00:00&lt;00:00, 10245.63it/s]  # noqa</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        &gt;&gt;&gt; work_estimator.s_friction_</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        array([..., ])</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">friction_error_</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="s1">&#39;n_resamples&#39;</span><span class="p">:</span> <span class="n">n_resamples</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="n">mode</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="p">}</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bootstrap_friction</span><span class="p">()</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_friction_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="dcTMD.dcTMD.ForceEstimator" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">ForceEstimator</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.ForceEstimator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="dcTMD.dcTMD._SmoothBasisEstimator">_SmoothBasisEstimator</span></code>, <code><span title="sklearn.base.TransformerMixin">TransformerMixin</span></code>, <code><span title="sklearn.base.BaseEstimator">BaseEstimator</span></code></p>


        <p>Class for performing dcTMD analysis on a force set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="beartype.typing.Union">Union</span>[<span title="dcTMD._typing.Float">Float</span>, <span title="dcTMD._typing.Int">Int</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Temperature at which the simulations were carried out, in K.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>verbose</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Enables verbose mode.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.ForceEstimator.position_">position_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Positions time trace, product of time trace and velocity, in nm.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.ForceEstimator.W_mean_">W_mean_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Mean work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.ForceEstimator.W_diss_">W_diss_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Dissipative work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.ForceEstimator.dG_">dG_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Free energy estimate, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="dcTMD.dcTMD.ForceEstimator.friction_">friction_</span></code></b>
          –
          <div class="doc-md-description">
            <p>Friction factor in kJ/mol/(nm^2/ps).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.dcTMD</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForceEstimator</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dcTMD.storing</span><span class="w"> </span><span class="kn">import</span> <span class="n">load</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">force</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_force_set&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Instantiate a ForceEstimator instance and fit it with the</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># ForceSet instance</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">force_estimator</span> <span class="o">=</span> <span class="n">ForceEstimator</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">290.15</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">force_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">force</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">force_estimator</span><span class="o">.</span><span class="n">dG_</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">array([..., ])</span>
</code></pre></div>

        <p>Initialize class.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Float</span><span class="p">,</span> <span class="n">Int</span><span class="p">],</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize class.&quot;&quot;&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.ForceEstimator.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">force_set</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.ForceEstimator.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate free energy and friction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>force_set</code></b>
          –
          <div class="doc-md-description">
            <p>Instance of ForceSet containing constraint forces, for which the
free energy and friction are estimated.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>self</code></b>          –
          <div class="doc-md-description">
            <p>Fitted estimator.</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">force_set</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="p">):</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Estimate free energy and friction.</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    force_set :</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        Instance of ForceSet containing constraint forces, for which the</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        free energy and friction are estimated.</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    -------</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    self :</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">        Fitted estimator.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span> <span class="o">=</span> <span class="n">force_set</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">names_</span> <span class="o">=</span> <span class="n">force_set</span><span class="o">.</span><span class="n">names_</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">estimate_free_energy_friction</span><span class="p">()</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.ForceEstimator.transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.ForceEstimator.transform" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return free energy and friction estimates.</p>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">]:</span>  <span class="c1"># noqa: WPS111</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return free energy and friction estimates.&quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dG_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">friction_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.ForceEstimator.estimate_free_energy_friction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_free_energy_friction</span><span class="p">()</span></code>

<a href="#dcTMD.dcTMD.ForceEstimator.estimate_free_energy_friction" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate free energy and friction from force auto correlation.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>W_mean</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Mean work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>W_diss</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Dissipative work, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>dG_</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Free energy estimate, in kJ/mol.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<b><code>friction_</code></b> (              <code>1D np.array</code>
)          –
          <div class="doc-md-description">
            <p>Friction factor in kJ/mol/(nm^2/ps).</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="nd">@beartype</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_free_energy_friction</span><span class="p">(</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">,</span> <span class="n">Float1DArray</span><span class="p">]:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Estimate free energy and friction from force auto correlation.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    -------</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    W_mean : 1D np.array</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        Mean work, in kJ/mol.</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    W_diss : 1D np.array</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        Dissipative work, in kJ/mol.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    dG_ : 1D np.array</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Free energy estimate, in kJ/mol.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    friction_ : 1D np.array</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        Friction factor in kJ/mol/(nm^2/ps).</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>  <span class="c1"># noqa: WPS347</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">cumulative_trapezoid</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="n">RT</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">/</span> <span class="mf">1e3</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="c1"># average and variance over all trajectories in each time step</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>    <span class="n">force_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">force_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="c1"># calculate $\delta f_c(t) = f_c(t) - \left&lt; f_c (t) \right&gt;_N$</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">force_</span> <span class="o">-</span> <span class="n">force_mean</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="c1"># integrate over time</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="n">int_delta_force</span> <span class="o">=</span> <span class="n">cumulative_trapezoid</span><span class="p">(</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_array</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">time_</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">intcorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_array</span><span class="p">,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">int_delta_force</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="n">friction_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">intcorr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">RT</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">W_mean_</span> <span class="o">=</span> <span class="n">cumulative_trapezoid</span><span class="p">(</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">force_mean</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">position_</span><span class="p">,</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="n">W_diss</span> <span class="o">=</span> <span class="n">cumulative_trapezoid</span><span class="p">(</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">friction_</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">position_</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">velocity</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="c1"># Reduce resolution</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">position_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">position_</span><span class="p">[::</span><span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">resolution</span><span class="p">]</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">W_mean_</span> <span class="o">=</span> <span class="n">W_mean_</span><span class="p">[::</span><span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">resolution</span><span class="p">]</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span> <span class="o">=</span> <span class="n">W_diss</span><span class="p">[::</span><span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">resolution</span><span class="p">]</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dG_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_mean_</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">friction_</span> <span class="o">=</span> <span class="n">friction_</span><span class="p">[::</span><span class="bp">self</span><span class="o">.</span><span class="n">force_set</span><span class="o">.</span><span class="n">resolution</span><span class="p">]</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_diss_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dG_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">friction_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dcTMD.dcTMD.ForceEstimator.memory_kernel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">memory_kernel</span><span class="p">(</span><span class="n">x_indices</span><span class="p">)</span></code>

<a href="#dcTMD.dcTMD.ForceEstimator.memory_kernel" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Calculate memory kernel at positions X "forward" in time.</p>
<p>From fluctuation-dissipation. See e.g. R. Zwanzig,
“Nonequilibrium statistical mechanics”, Oxford University Press (2001).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>x_indices</code></b>
              (<code><span title="dcTMD._typing.Float1DArray">Float1DArray</span></code>)
          –
          <div class="doc-md-description">
            <p>Indices at which memory kernel is calculated.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>corr_set</code></b> (              <code><span title="dcTMD._typing.Float1DArray">Float1DArray</span></code>
)          –
          <div class="doc-md-description">
            <p>shape: (len(X), length_data)
NaN are set to zero</p>
          </div>
        </li>
    </ul>


            <details class="quote">
              <summary>Source code in <code>src/dcTMD/dcTMD.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="k">def</span><span class="w"> </span><span class="nf">memory_kernel</span><span class="p">(</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">x_indices</span><span class="p">:</span> <span class="n">Float1DArray</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Float1DArray</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    Calculate memory kernel at positions X &quot;forward&quot; in time.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    From fluctuation-dissipation. See e.g. R. Zwanzig,</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    “Nonequilibrium statistical mechanics”, Oxford University Press (2001).</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    x_indices :</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        Indices at which memory kernel is calculated.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    -------</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    corr_set :</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        shape: (len(X), length_data)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        NaN are set to zero</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">length_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="n">corr_set</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_indices</span><span class="p">),</span> <span class="n">length_data</span><span class="p">))</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">length_data</span><span class="p">)):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_</span><span class="p">[:,</span> <span class="n">tt</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> \
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delta_force_</span><span class="p">[:,</span> <span class="n">tt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># noqa: N400</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">corr_set</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">tt</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="n">entries</span><span class="p">,</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="k">return</span> <span class="n">corr_set</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-2023 Biomolecular Dynamics
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.moldyn.uni-freiburg.de" target="_blank" rel="noopener" title="www.moldyn.uni-freiburg.de" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/moldyn" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/MolDynFR" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.top"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>